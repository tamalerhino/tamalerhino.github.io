<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Container Image Pipeline With SBOM" /><meta property="og:locale" content="en" /><meta name="description" content="This is to go over a container image pipeline that will scan for vulnerabilities and generate a Software Bill of Materials at the end." /><meta property="og:description" content="This is to go over a container image pipeline that will scan for vulnerabilities and generate a Software Bill of Materials at the end." /><link rel="canonical" href="https://tamalerhino.github.io/posts/container-image-pipeline-with-sbom/" /><meta property="og:url" content="https://tamalerhino.github.io/posts/container-image-pipeline-with-sbom/" /><meta property="og:site_name" content="Tamalerhino’s Blog" /><meta property="og:image" content="https://tamalerhino.github.io/pexels-magda-ehlers-2569842.jpg" /><meta property="og:image:height" content="800" /><meta property="og:image:width" content="1000" /><meta property="og:image:alt" content="Pipelines" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-12T11:00:00-06:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://tamalerhino.github.io/pexels-magda-ehlers-2569842.jpg" /><meta name="twitter:image:alt" content="Pipelines" /><meta property="twitter:title" content="Container Image Pipeline With SBOM" /><meta name="twitter:site" content="@tamalerhino" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-10T22:28:50-05:00","datePublished":"2022-03-12T11:00:00-06:00","description":"This is to go over a container image pipeline that will scan for vulnerabilities and generate a Software Bill of Materials at the end.","headline":"Container Image Pipeline With SBOM","image":{"width":1000,"height":800,"alt":"Pipelines","url":"https://tamalerhino.github.io/pexels-magda-ehlers-2569842.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tamalerhino.github.io/posts/container-image-pipeline-with-sbom/"},"url":"https://tamalerhino.github.io/posts/container-image-pipeline-with-sbom/"}</script><title>Container Image Pipeline With SBOM | Tamalerhino's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tamalerhino's Blog"><meta name="application-name" content="Tamalerhino's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/tamalerhino2-1mb.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Tamalerhino's Blog</a></div><div class="site-subtitle font-italic">Just one rhino's thoughts.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tamalerhino" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/tamalerhino" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/ulises-galeano/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Container Image Pipeline With SBOM</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Container Image Pipeline With SBOM</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1647104400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 12, 2022 </em> </span> <span> Updated <em class="" data-ts="1657510130" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 10, 2022 </em> </span><div class="mt-3 mb-3"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 800'%3E%3C/svg%3E" data-src="/assets/img/posts/pexels-magda-ehlers-2569842.jpg" class="preview-img bg" alt="Pipelines" width="1000" height="800" data-proofer-ignore><figcaption class="pt-2 pb-2">Pipelines</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/tamalerhino">Ulises Galeano</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1420 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p>This is to go over a container image pipeline that will scan for vulnerabilities and generate a Software Bill of Materials at the end.</p><h1 id="proposed-architecture">Proposed Architecture</h1><pre><code class="language-mermaid">graph TD
    A[Dev User Pushes Dockerfile to git repo] --&gt;|git repo notifies Jenkins| B(Jenkins pulls down repo and kicks off job) --&gt;|Pipeline Builds Docker Image| C(Dependencies are pulled from artifact management system) --&gt;|Trivy runs against the docker image,the FS and the code| D(Jenkins pulls down repo and kicks off job)
    D --&gt; E{Vuln Scan}
    E --&gt;|Passes| F[Docker Image is uploaded to artifact management system]
    F --&gt; G(SBOM gets genrated and uploaded to artifact mangament system)
    E --&gt;|fails| H[pipeline fails and stops]
</code></pre><h1 id="trivy">Trivy</h1><h2 id="what-is-trivy"><span class="mr-2">What is Trivy?</span><a href="#what-is-trivy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Trivy (tri pronounced like trigger, vy pronounced like envy) is a simple and comprehensive scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues. Trivy detects vulnerabilities of OS packages (Alpine, RHEL, CentOS, etc.) and language-specific packages (Bundler, Composer, npm, yarn, etc.). In addition, Trivy scans Infrastructure as Code (IaC) files such as Terraform, Dockerfile and Kubernetes, to detect potential configuration issues that expose your deployments to the risk of attack. Trivy also scans hardcoded secrets like passwords, API keys and tokens. Trivy is easy to use. Just install the binary and you’re ready to scan.</p><p><img data-src="https://aquasecurity.github.io/trivy/v0.29.2/imgs/overview.png" alt="Trivy" data-proofer-ignore></p><h2 id="features"><span class="mr-2">Features</span><a href="#features" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Comprehensive vulnerability detection<ul><li>OS packages (Alpine Linux, Red Hat Universal Base Image, Red Hat Enterprise Linux, CentOS, AlmaLinux, Rocky Linux, CBL-Mariner, Oracle Linux, Debian, Ubuntu, Amazon Linux, openSUSE Leap, SUSE Enterprise Linux, Photon OS and Distroless)</ul><li>Language-specific packages (Bundler, Composer, Pipenv, Poetry, npm, yarn, Cargo, NuGet, Maven, and Go) Misconfiguration detection (IaC scanning)<ul><li>A wide variety of built-in policies are provided out of the box<ul><li>Kubernetes, Docker, Terraform, and more coming soon</ul><li>Support custom policies</ul><li>Secret detection<ul><li>A wide variety of built-in rules are provided out of the box<li>Support custom rules<li>Scan container images at a high speed</ul><li>Simple<ul><li>Specify only an image name, a path to config files, or an artifact name</ul><li>Fast<ul><li>The first scan will finish within 10 seconds (depending on your network). Consequent scans will finish in a single second.</ul><li>Easy installation<ul><li>apt-get install, yum install and brew install are possible.<li>No pre-requisites such as installation of DB, libraries, etc.</ul><li>High accuracy<ul><li>Especially <a href="https://ariadne.space/2021/06/08/the-vulnerability-remediation-lifecycle-of-alpine-containers/">Alpine Linux</a> and RHEL/CentOS<li>Other OSes are also high</ul><li>DevSecOps<ul><li>Suitable for CI such as GitHub Actions, Jenkins, GitLab CI, etc.</ul><li>Support multiple targets<ul><li>container image, local filesystem, and remote git repository</ul><li>Supply chain security (SBOM support)<ul><li>Support CycloneDX<li>Support SPDX</ul></ul><h2 id="integrations"><span class="mr-2">Integrations</span><a href="#integrations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>VSCode via an extension -https://github.com/aquasecurity/trivy-vscode-extension</p><p>Docker Dekstop via an extension - https://github.com/aquasecurity/trivy-docker-extension#:~:text=Trivy%20Docker%20Extension-,What%20is%20this%3F,image%20into%20the%20drop%20down</p><h2 id="sboms"><span class="mr-2">SBOM’s</span><a href="#sboms" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Trivy can create a Software Bill of Materials!</p><h3 id="for-containers"><span class="mr-2">For Containers:</span><a href="#for-containers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&gt;</span><span class="nv">$ </span>trivy sbom &lt;imagename&gt;
</pre></table></code></div></div><h3 id="for-filesystems"><span class="mr-2">For Filesystems:</span><a href="#for-filesystems" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&gt;</span><span class="nv">$ </span>trivy sbom <span class="nt">--artifact-type</span> fs ./
</pre></table></code></div></div><h3 id="for-git-repos"><span class="mr-2">For Git Repos:</span><a href="#for-git-repos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&gt;</span><span class="nv">$ </span>trivy sbom <span class="nt">--artifact-type</span> repo &lt;repo&gt;
</pre></table></code></div></div><h2 id="where-does-trivy-get-its-data-sources-from"><span class="mr-2">Where does Trivy get its data sources from?</span><a href="#where-does-trivy-get-its-data-sources-from" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Data sources official doc: https://aquasecurity.github.io/trivy/v0.28.1/docs/vulnerability/detection/data-source/</p><h1 id="os">OS</h1><div class="table-wrapper"><table><thead><tr><th>OS<th>Source<tbody><tr><td>Arch Linux<td><a href="https://security.archlinux.org/">Vulnerable Issues</a><tr><td>Alpine Linux<td><a href="https://secdb.alpinelinux.org/">secdb</a><tr><td>Amazon Linux 1<td><a href="https://alas.aws.amazon.com/">Amazon Linux Security Center</a><tr><td>Amazon Linux 2<td><a href="https://alas.aws.amazon.com/alas2.html">Amazon Linux Security Center</a><tr><td>Debian<td><a href="https://security-tracker.debian.org/tracker/">Security Bug Tracker</a><tr><td> <td><a href="https://www.debian.org/security/oval/">OVAL</a><tr><td>Ubuntu<td><a href="https://ubuntu.com/security/cve">Ubuntu CVE Tracker</a><tr><td>RHEL/CentOS<td><a href="https://www.redhat.com/security/data/oval/v2/">OVAL</a><tr><td> <td><a href="https://www.redhat.com/security/data/metrics/">Security Data</a><tr><td>AlmaLinux<td><a href="https://errata.almalinux.org/">AlmaLinux Product Errata</a><tr><td>Rocky Linux<td><a href="https://download.rockylinux.org/pub/rocky/">Rocky Linux UpdateInfo</a><tr><td>Oracle Linux<td><a href="https://linux.oracle.com/security/oval/">OVAL</a><tr><td>CBL-Mariner<td><a href="https://github.com/microsoft/CBL-MarinerVulnerabilityData/">OVAL</a><tr><td>OpenSUSE/SLES<td><a href="http://ftp.suse.com/pub/projects/security/cvrf/">CVRF</a><tr><td>Photon OS<td><a href="https://packages.vmware.com/photon/photon_cve_metadata/">Photon Security Advisory</a></table></div><h1 id="programming-language">Programming Language</h1><div class="table-wrapper"><table><thead><tr><th>Language<th>Source<th style="text-align: center">Commercial Use<th style="text-align: center">Delay<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup><tbody><tr><td>PHP<td><a href="https://github.com/FriendsOfPHP/security-advisories">PHP Security Advisories Database</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td> <td><a href="https://github.com/advisories?query=ecosystem%3Acomposer">GitHub Advisory Database (Composer)</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td>Python<td><a href="https://github.com/advisories?query=ecosystem%3Apip">GitHub Advisory Database (pip)</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td> <td><a href="https://osv.dev/list?q=&amp;ecosystem=PyPI">Open Source Vulnerabilities (PyPI)</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td>Ruby<td><a href="https://github.com/rubysec/ruby-advisory-db">Ruby Advisory Database</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td> <td><a href="https://github.com/advisories?query=ecosystem%3Arubygems">GitHub Advisory Database (RubyGems)</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td>Node.js<td><a href="https://github.com/nodejs/security-wg">Ecosystem Security Working Group</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td> <td><a href="https://github.com/advisories?query=ecosystem%3Anpm">GitHub Advisory Database (npm)</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td>Java<td><a href="https://gitlab.com/gitlab-org/advisories-community">GitLab Advisories Community</a><td style="text-align: center">✅<td style="text-align: center">1 month<tr><td> <td><a href="https://github.com/advisories?query=ecosystem%3Amaven">GitHub Advisory Database (Maven)</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td>Go<td><a href="https://gitlab.com/gitlab-org/advisories-community">GitLab Advisories Community</a><td style="text-align: center">✅<td style="text-align: center">1 month<tr><td> <td><a href="https://github.com/golang/vulndb">The Go Vulnerability Database</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td>Rust<td><a href="https://osv.dev/list?q=&amp;ecosystem=crates.io">Open Source Vulnerabilities (crates.io)</a><td style="text-align: center">✅<td style="text-align: center">-<tr><td>.NET<td><a href="https://github.com/advisories?query=ecosystem%3Anuget">GitHub Advisory Database (NuGet)</a><td style="text-align: center">✅<td style="text-align: center">-</table></div><h1 id="others">Others</h1><div class="table-wrapper"><table><thead><tr><th>Name<th>Source<tbody><tr><td>National Vulnerability Database<td><a href="https://nvd.nist.gov/">NVD</a></table></div><h1 id="data-source-selection">Data source selection</h1><p>Trivy <strong>only</strong> consumes security advisories from the sources listed in the following tables.</p><p>As for packages installed from OS package managers (<code class="language-plaintext highlighter-rouge">dpkg</code>, <code class="language-plaintext highlighter-rouge">yum</code>, <code class="language-plaintext highlighter-rouge">apk</code>, etc.), Trivy uses the advisory database from the appropriate <strong>OS vendor</strong>.</p><p>For example: for a python package installed from <code class="language-plaintext highlighter-rouge">yum</code> (Amazon linux), Trivy will only get advisories from <a href="https://alas.aws.amazon.com/alas2.html">ALAS</a>. But for a python package installed from another source (e.g. <code class="language-plaintext highlighter-rouge">pip</code>), Trivy will get advisories from the <code class="language-plaintext highlighter-rouge">GitLab</code> and <code class="language-plaintext highlighter-rouge">GitHub</code> databases.</p><p>This advisory selection is essential to avoid getting false positives because OS vendors usually backport upstream fixes, and the fixed version can be different from the upstream fixed version. The severity is from the selected data source. If the data source does not provide severity, it falls back to NVD, and if NVD does not have severity, it will be UNKNOWN.</p><h2 id="ari-gapped-environment"><span class="mr-2">Ari-Gapped Environment</span><a href="#ari-gapped-environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Trivy can be used in air-gapped environments. Note that an allowlist is <a href="https://aquasecurity.github.io/trivy/v0.28.1/docs/references/troubleshooting/">here</a>.</p><ul><li>ghcr.io<li>pkg-containers.githubusercontent.com</ul><h3 id="air-gapped-environment-for-vulnerabilities"><span class="mr-2">Air-Gapped Environment for Vulnerabilities</span><a href="#air-gapped-environment-for-vulnerabilities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="download-the-vulnerability-database"><span class="mr-2">Download the vulnerability database</span><a href="#download-the-vulnerability-database" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>At first, you need to download the vulnerability database for use in air-gapped environments. Please follow <a href="https://oras.land/cli/">oras installation instruction</a>.</p><p>Download db.tar.gz:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oras pull ghcr.io/aquasecurity/trivy-db:2 <span class="nt">-a</span>
</pre></table></code></div></div><h4 id="transfer-the-db-file-into-the-air-gapped-environment"><span class="mr-2">Transfer the DB file into the air-gapped environment</span><a href="#transfer-the-db-file-into-the-air-gapped-environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The way of transfer depends on the environment.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>rsync <span class="nt">-av</span> <span class="nt">-e</span> ssh /path/to/db.tar.gz <span class="o">[</span>user]@[host]:dst
</pre></table></code></div></div><h4 id="put-the-db-file-in-trivys-cache-directory"><span class="mr-2">Put the DB file in Trivy’s cache directory</span><a href="#put-the-db-file-in-trivys-cache-directory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>You have to know where to put the DB file. The following command shows the default cache directory.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ssh user@host
<span class="nv">$ </span>trivy <span class="nt">-h</span> | <span class="nb">grep </span>cache
   <span class="nt">--cache-dir</span> value  cache directory <span class="o">(</span>default: <span class="s2">"/home/myuser/.cache/trivy"</span><span class="o">)</span> <span class="o">[</span><span class="nv">$TRIVY_CACHE_DIR</span><span class="o">]</span>
</pre></table></code></div></div><p>Put the DB file in the cache directory + /db.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> /home/myuser/.cache/trivy/db
<span class="nv">$ </span><span class="nb">cd</span> /home/myuser/.cache/trivy/db
<span class="nv">$ </span><span class="nb">tar </span>xvf /path/to/db.tar.gz <span class="nt">-C</span> /home/myuser/.cache/trivy/db
x trivy.db
x metadata.json
<span class="nv">$ </span><span class="nb">rm</span> /path/to/db.tar.gz
</pre></table></code></div></div><p>In an air-gapped environment, it is your responsibility to update the Trivy database on a regular basis so that the scanner can detect recently-identified vulnerabilities.</p><h4 id="run-trivy-with-skip-update-and-offline-scan-option"><span class="mr-2">Run Trivy with –skip-update and –offline-scan option</span><a href="#run-trivy-with-skip-update-and-offline-scan-option" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>In an air-gapped environment, specify –skip-update so that Trivy doesn’t attempt to download the latest database file. In addition, if you want to scan Java dependencies such as JAR and pom.xml, you need to specify –offline-scan since Trivy tries to issue API requests for scanning Java applications by default.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>trivy image <span class="nt">--skip-update</span> <span class="nt">--offline-scan</span> alpine:3.12
</pre></table></code></div></div><h3 id="air-gapped-environment-for-misconfigurations"><span class="mr-2">Air-Gapped Environment for misconfigurations</span><a href="#air-gapped-environment-for-misconfigurations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>No special measures are required to detect misconfigurations in an air-gapped environment.</p><h4 id="run-trivy-with-skip-policy-update-option"><span class="mr-2">Run Trivy with –skip-policy-update option</span><a href="#run-trivy-with-skip-policy-update-option" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>In an air-gapped environment, specify –skip-policy-update so that Trivy doesn’t attempt to download the latest misconfiguration policies.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>trivy conf <span class="nt">--skip-policy-update</span> /path/to/conf
</pre></table></code></div></div><h2 id="exceptions--custom-policies"><span class="mr-2">Exceptions / Custom Policies</span><a href="#exceptions--custom-policies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Exceptions let you specify cases where you allow policy violations. Trivy supports two types of exceptions. Example:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>package user.kubernetes.ID100

__rego_metadata :<span class="o">=</span> <span class="o">{</span>
    <span class="s2">"id"</span>: <span class="s2">"ID100"</span>,
    <span class="s2">"title"</span>: <span class="s2">"Deployment not allowed"</span>,
    <span class="s2">"severity"</span>: <span class="s2">"HIGH"</span>,
    <span class="s2">"type"</span>: <span class="s2">"Kubernetes Custom Check"</span>,
<span class="o">}</span>

deny_deployment[msg] <span class="o">{</span>
    input.kind <span class="o">==</span> <span class="s2">"Deployment"</span>
    msg <span class="o">=</span> sprintf<span class="o">(</span><span class="s2">"Found deployment '%s' but deployments are not allowed"</span>, <span class="o">[</span>name]<span class="o">)</span>
<span class="o">}</span>

exception[rules] <span class="o">{</span>
    input.kind <span class="o">==</span> <span class="s2">"Deployment"</span>
    input.metadata.name <span class="o">==</span> <span class="s2">"allow-deployment"</span>

    rules :<span class="o">=</span> <span class="o">[</span><span class="s2">"deployment"</span><span class="o">]</span>
<span class="o">}</span>
</pre></table></code></div></div><h3 id="custom-polcies"><span class="mr-2">Custom Polcies</span><a href="#custom-polcies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>You can write custom policies in <a href="https://www.openpolicyagent.org/docs/latest/policy-language/">Rego</a>. Once you finish writing custom policies, you can pass the directory where those policies are stored with –policy option.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>trivy conf <span class="nt">--policy</span> /path/to/custom_policies <span class="nt">--namespaces</span> user /path/to/config_dir
</pre></table></code></div></div><h4 id="file-formats"><span class="mr-2">File formats</span><a href="#file-formats" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="table-wrapper"><table><thead><tr><th>File format<th>File pattern<tbody><tr><td>JSON<td><code class="language-plaintext highlighter-rouge">*.json</code><tr><td>YAML<td><code class="language-plaintext highlighter-rouge">*.yaml</code> and <code class="language-plaintext highlighter-rouge">*.yml</code><tr><td>Dockerfile<td><code class="language-plaintext highlighter-rouge">Dockerfile</code>, <code class="language-plaintext highlighter-rouge">Dockerfile.*</code>, and <code class="language-plaintext highlighter-rouge">*.Dockerfile</code><tr><td>Containerfile<td><code class="language-plaintext highlighter-rouge">Containerfile</code>, <code class="language-plaintext highlighter-rouge">Containerfile.*</code>, and <code class="language-plaintext highlighter-rouge">*.Containerfile</code><tr><td>Terraform<td><code class="language-plaintext highlighter-rouge">*.tf</code> and <code class="language-plaintext highlighter-rouge">*.tf.json</code></table></div><h4 id="example"><span class="mr-2">Example:</span><a href="#example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>package user.kubernetes.ID001

__rego_metadata__ :<span class="o">=</span> <span class="o">{</span>
    <span class="s2">"id"</span>: <span class="s2">"ID001"</span>,
    <span class="s2">"title"</span>: <span class="s2">"Deployment not allowed"</span>,
    <span class="s2">"severity"</span>: <span class="s2">"LOW"</span>,
    <span class="s2">"type"</span>: <span class="s2">"Custom Kubernetes Check"</span>,
    <span class="s2">"description"</span>: <span class="s2">"Deployments are not allowed because of some reasons."</span>,
<span class="o">}</span>

__rego_input__ :<span class="o">=</span> <span class="o">{</span>
    <span class="s2">"selector"</span>: <span class="o">[</span>
        <span class="o">{</span><span class="s2">"type"</span>: <span class="s2">"kubernetes"</span><span class="o">}</span>,
    <span class="o">]</span>,
<span class="o">}</span>

deny[msg] <span class="o">{</span>
    input.kind <span class="o">==</span> <span class="s2">"Deployment"</span>
    msg <span class="o">=</span> sprintf<span class="o">(</span><span class="s2">"Found deployment '%s' but deployments are not allowed"</span>, <span class="o">[</span>input.metadata.name]<span class="o">)</span>
<span class="o">}</span>
</pre></table></code></div></div><h1 id="pipeline">Pipeline</h1><h2 id="jenkins-pipeline"><span class="mr-2">Jenkins Pipeline</span><a href="#jenkins-pipeline" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We will be using Jenkins as our main orchestrator. Created my own here: https://github.com/tamalerhino/chubby-unicorn/blob/main/Jenkinsfile</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="nx">pipeline</span> <span class="p">{</span>
  <span class="nx">agent</span> <span class="nx">any</span>
  <span class="nx">options</span> <span class="p">{</span>
    <span class="nx">buildDiscarder</span><span class="p">(</span><span class="nx">logRotator</span><span class="p">(</span><span class="nx">numToKeepStr</span><span class="p">:</span> <span class="dl">'</span><span class="s1">5</span><span class="dl">'</span><span class="p">))</span>
  <span class="p">}</span>
  <span class="nx">stages</span> <span class="p">{</span>
    <span class="nx">stage</span><span class="p">(</span><span class="dl">'</span><span class="s1">Build</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">steps</span> <span class="p">{</span>
        <span class="nx">sh</span> <span class="dl">'</span><span class="s1">docker build -t "${IMAGENAME}" .</span><span class="dl">'</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">stage</span><span class="p">(</span><span class="dl">'</span><span class="s1">Scan</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">steps</span> <span class="p">{</span>
        <span class="nx">sh</span> <span class="dl">'</span><span class="s1">trivy image --exit-code 1 --severity MEDIUM,HIGH,CRITICAL "${IMAGENAME}"</span><span class="dl">'</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nx">stage</span><span class="p">(</span><span class="dl">'</span><span class="s1">Create SBOM</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">steps</span> <span class="p">{</span>
        <span class="nx">sh</span> <span class="dl">'</span><span class="s1">trivy --output "${IMAGENAME}".json sbom "${IMAGENAME}"</span><span class="dl">'</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">stage</span><span class="p">(</span><span class="dl">'</span><span class="s1">Upload Artifacts</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">steps</span> <span class="p">{</span>
        <span class="nx">sh</span> <span class="dl">'</span><span class="s1">docker login "${CONTAINER-REPO-URL}" -u="${CONTAINER-REPO-USERNAME}" -p="${CONTAINER-REPO-PASSWORD]"</span><span class="dl">'</span>
        <span class="nx">sh</span> <span class="dl">'</span><span class="s1">docker tag "${IMAGENAME}" "${CONTAINERPROJECT}"/"${IMAGENAME}"</span><span class="dl">'</span>
        <span class="nx">sh</span> <span class="dl">'</span><span class="s1">docker push "${CONTAINER-REPO-URL}"/"${CONTAINERPROJECT}"/"${IMAGENAME}"</span><span class="dl">'</span>
      <span class="p">}</span>
       <span class="nx">steps</span> <span class="p">{</span>
        <span class="nx">sh</span> <span class="dl">'</span><span class="s1">curl -u "${USERNAME}":"${PASSWORD}" -X PUT  "${ARTIFACTORY-RUL}/"${CONTAINERPROJECT}"/"${IMAGENAME}".json" -T "${IMAGENAME}".json</span><span class="dl">'</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="footnotes" role="doc-endnotes"><ol><li id="fn:1" role="doc-endnote"><p>Intentional delay between vulnerability disclosure and registration in the DB <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/containerization/'>Containerization</a>, <a href='/categories/devsecops/'>DevSecOps</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/containerization/" class="post-tag no-text-decoration" >containerization</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/devsecops/" class="post-tag no-text-decoration" >devsecops</a> <a href="/tags/sbom/" class="post-tag no-text-decoration" >SBOM</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Container+Image+Pipeline+With+SBOM+-+Tamalerhino%27s+Blog&url=https%3A%2F%2Ftamalerhino.github.io%2Fposts%2Fcontainer-image-pipeline-with-sbom%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Container+Image+Pipeline+With+SBOM+-+Tamalerhino%27s+Blog&u=https%3A%2F%2Ftamalerhino.github.io%2Fposts%2Fcontainer-image-pipeline-with-sbom%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftamalerhino.github.io%2Fposts%2Fcontainer-image-pipeline-with-sbom%2F&text=Container+Image+Pipeline+With+SBOM+-+Tamalerhino%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/container-from-scratch/">Containers From Scratch Part 1</a><li><a href="/posts/systemd-namespace-containers/">Systemd Namespace Containers</a><li><a href="/posts/docker-debian-airgapped/">Install Docker Air Gapped</a><li><a href="/posts/docker-desktop-wsl2-deep-dive/">Docker Desktop WSL2 Deep Dive</a><li><a href="/posts/how-to-abuse-container-repositories-for-fun-and-profit/">How To Abuse Container Repositories For Fun And Profit</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/containerization/">containerization</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/docker-desktop/">docker desktop</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/wsl2/">wsl2</a> <a class="post-tag" href="/tags/wsl/">wsl</a> <a class="post-tag" href="/tags/data-exfiltration/">data exfiltration</a> <a class="post-tag" href="/tags/devsecops/">devsecops</a> <a class="post-tag" href="/tags/dlp/">dlp</a> <a class="post-tag" href="/tags/hacking/">hacking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/docker-desktop-wsl2-deep-dive/"><div class="card-body"> <em class="small" data-ts="1633107600" data-df="ll" > Oct 1, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Docker Desktop WSL2 Deep Dive</h3><div class="text-muted small"><p> In the last few years theres been a big push for Docker Desktop on developer workstations, many of those workstations being Mac and Windows not Linux. But since containers need a Linux kernel to ru...</p></div></div></a></div><div class="card"> <a href="/posts/how-to-abuse-container-repositories-for-fun-and-profit/"><div class="card-body"> <em class="small" data-ts="1635008400" data-df="ll" > Oct 23, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How To Abuse Container Repositories For Fun And Profit</h3><div class="text-muted small"><p> Often as security engineers we are worried about what vulnerabilites can be downloaded from container registries, howver i believe the same could be used to exfiltrate data. We will go over what a...</p></div></div></a></div><div class="card"> <a href="/posts/creating-a-custom-wsl2-image/"><div class="card-body"> <em class="small" data-ts="1636650000" data-df="ll" > Nov 11, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Creating A Custom WSL2 Image</h3><div class="text-muted small"><p> Recently with the usage of Docker Desktop, there has been a need to use WSL2 to run Docker Desktop on Windows. However because of the various security implications, missing security kernel modules,...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/systemd-namespace-containers/" class="btn btn-outline-primary" prompt="Older"><p>Systemd Namespace Containers</p></a> <a href="/posts/docker-debian-airgapped/" class="btn btn-outline-primary" prompt="Newer"><p>Install Docker Air Gapped</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/tamalerhino">Ulises Galeano</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/containerization/">containerization</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/docker-desktop/">docker desktop</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/wsl2/">wsl2</a> <a class="post-tag" href="/tags/wsl/">wsl</a> <a class="post-tag" href="/tags/data-exfiltration/">data exfiltration</a> <a class="post-tag" href="/tags/devsecops/">devsecops</a> <a class="post-tag" href="/tags/dlp/">dlp</a> <a class="post-tag" href="/tags/hacking/">hacking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
